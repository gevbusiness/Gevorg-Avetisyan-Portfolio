"use strict";(self["webpackChunk_zoom_client_email_desktop"]=self["webpackChunk_zoom_client_email_desktop"]||[]).push([[244],{48244:function(e,t,i){i.r(t),i.d(t,{default:function(){return g}});var a=function(){var e=this,t=e._self._c;return t("zm-dialog",{ref:"dialog",attrs:{title:e.$t("filter.addAFilter"),visible:e.visible,top:"4vh",width:"548px","append-to-body":""}},[t("filter-criteria",{directives:[{name:"show",rawName:"v-show",value:1===e.step,expression:"step === 1"}],ref:"criteriaForm",attrs:{filterEdits:e.filterEdits},on:{update:e.handleCriteriaUpdate}}),t("filter-actions",{directives:[{name:"show",rawName:"v-show",value:2===e.step,expression:"step === 2"}],ref:"actionsForm",attrs:{filterEdits:e.filterEdits,userLabels:e.userLabels},on:{update:e.handleActionsUpdate}}),t("span",{staticClass:"add-filter-footer",attrs:{slot:"footer"},slot:"footer"},[t("zm-button",{staticClass:"button-left",attrs:{tabindex:"0"},on:{click:e.handleCancel}},[e._v(e._s(e.$t("operation.cancel")))]),t("section",{staticClass:"button-right"},[t("zm-button",{directives:[{name:"show",rawName:"v-show",value:2===e.step,expression:"step === 2"}],attrs:{disabled:e.loading,tabindex:"0"},on:{click:function(t){e.step=1}}},[e._v(" "+e._s(e.$t("common.back"))+" ")]),t("zm-button",{directives:[{name:"show",rawName:"v-show",value:1===e.step,expression:"step === 1"}],attrs:{type:"primary",tabindex:"0",disabled:!e.isCriteriaExist},on:{click:e.handleNextStep}},[e._v(" "+e._s(e.$t("operation.next"))+" ")]),t("zm-button",{directives:[{name:"show",rawName:"v-show",value:2===e.step,expression:"step === 2"}],attrs:{type:"primary",disabled:!e.isFulfilled,loading:e.loading,tabindex:"0"},on:{click:e.handleSubmit}},[e._v(" "+e._s(e.$t("common.create"))+" ")])],1)],1)],1)},r=[],n=i(70021),l=i(56706),s=i(68571),o=i(34948),c=i(35368),d=i.n(c),m=i(20629),u=i(46815),f=function(){var e=this,t=e._self._c;return t("section",{staticClass:"filter-criteria-container"},[t("p",{staticClass:"label"},[e._v(e._s(e.$t("filter.filterCriteria")))]),t("zm-form",{ref:"form",staticClass:"filter-criteria-form",attrs:{model:e.formInline,rules:e.rules,"label-position":"top"}},[t("zm-form-item",{attrs:{label:e.$t("filter.from"),prop:"from",for:"formInline-from"}},[t("zm-input",{staticClass:"input-box",attrs:{label:""},model:{value:e.formInline.from,callback:function(t){e.$set(e.formInline,"from",t)},expression:"formInline.from"}})],1),e.isGmail?t("zm-form-item",{attrs:{label:e.$t("filter.subject"),prop:"subject",for:"formInline-subject"}},[t("zm-input",{staticClass:"input-box",attrs:{label:""},model:{value:e.formInline.subject,callback:function(t){e.$set(e.formInline,"subject",t)},expression:"formInline.subject"}})],1):e._e(),e.isGmail?t("zm-form-item",{attrs:{label:e.$t("filter.contains"),prop:"query",for:"formInline-query"}},[t("zm-input",{staticClass:"input-box",attrs:{label:""},model:{value:e.formInline.query,callback:function(t){e.$set(e.formInline,"query",t)},expression:"formInline.query"}})],1):e._e(),e.isGmail?t("zm-form-item",{attrs:{label:e.$t("filter.doesNotContain"),prop:"negatedQuery",for:"formInline-negatedQuery"}},[t("zm-input",{staticClass:"input-box",attrs:{label:""},model:{value:e.formInline.negatedQuery,callback:function(t){e.$set(e.formInline,"negatedQuery",t)},expression:"formInline.negatedQuery"}})],1):e._e(),t("zm-form-item",{attrs:{label:e.$t("filter.size"),prop:"sizeValue",for:"formInline-sizeValue"}},[t("section",{style:{display:"flex"}},[t("zm-select",{staticClass:"input-select",attrs:{label:""},model:{value:e.formInline.sizeComparison,callback:function(t){e.$set(e.formInline,"sizeComparison",t)},expression:"formInline.sizeComparison"}},[t("zm-option",{key:"larger",attrs:{label:e.$t("filter.greaterThan"),value:"larger"}}),t("zm-option",{key:"smaller",attrs:{label:e.$t("filter.lessThan"),value:"smaller"}})],1),t("zm-input",{staticClass:"input-box",attrs:{label:"",type:"number",min:1,max:e.maxAmount,step:1},model:{value:e.formInline.sizeValue,callback:function(t){e.$set(e.formInline,"sizeValue",t)},expression:"formInline.sizeValue"}}),t("zm-select",{staticClass:"input-unit",attrs:{label:""},model:{value:e.formInline.sizeUnit,callback:function(t){e.$set(e.formInline,"sizeUnit",t)},expression:"formInline.sizeUnit"}},[t("zm-option",{key:"MB",attrs:{label:"MB",value:"MB"}}),t("zm-option",{key:"KB",attrs:{label:"KB",value:"KB"}}),t("zm-option",{key:"Bytes",attrs:{label:"Bytes",value:"Bytes"}})],1)],1)]),t("zm-form-item",{attrs:{label:"",prop:"hasAttachment",for:"formInline-hasAttachment"}},[t("zm-checkbox",{model:{value:e.formInline.hasAttachment,callback:function(t){e.$set(e.formInline,"hasAttachment",t)},expression:"formInline.hasAttachment"}},[t("span",{staticClass:"checkbox-label"},[e._v(e._s(e.$t("filter.hasAttachment")))])])],1)],1)],1)},h=[],b=2147483648,p={name:"FilterCriteria",props:{filterEdits:{type:Object,default:function(){}}},data:function(){return{maxAmount:b/1e6-1,formInline:{from:"",to:"",subject:"",query:"",negatedQuery:"",sizeComparison:"larger",sizeValue:"",sizeUnit:"MB",excludeChats:!1,hasAttachment:!1},rules:{sizeValue:[{validator:this.validateSizeValue,trigger:"blur"}]}}},computed:(0,o.Z)((0,o.Z)({},(0,m.Se)(["isGmail"])),{},{formatSize:function(){return function(e){return isNaN(e)?"":e<1e3?e:e<1e6?(e/1e3).toFixed(0):(e/1e6).toFixed(0)}},formatUnit:function(){return function(e){return e<1e3?"Bytes":e<1e6?"KB":"MB"}}}),watch:{formInline:{handler:function(e){this.$emit("update",e)},immediate:!0}},methods:{init:function(){var e,t,i,a,r,n,l,s,o,c,d,m,u,f,h,b;this.formInline.from=(null===(e=this.filterEdits)||void 0===e||null===(t=e.criteria)||void 0===t?void 0:t.from)||"",this.formInline.to=(null===(i=this.filterEdits)||void 0===i||null===(a=i.criteria)||void 0===a?void 0:a.to)||"",this.formInline.subject=(null===(r=this.filterEdits)||void 0===r||null===(n=r.criteria)||void 0===n?void 0:n.subject)||"",this.formInline.query=(null===(l=this.filterEdits)||void 0===l||null===(s=l.criteria)||void 0===s?void 0:s.query)||"",this.formInline.negatedQuery=(null===(o=this.filterEdits)||void 0===o||null===(c=o.criteria)||void 0===c?void 0:c.negatedQuery)||"",this.formInline.sizeComparison=(null===(d=this.filterEdits)||void 0===d||null===(m=d.criteria)||void 0===m?void 0:m.sizeComparison)||"larger",this.formInline.sizeValue=this.formatSize(this.filterEdits.criteria.size)||"",this.formInline.sizeUnit=this.formatUnit(this.filterEdits.criteria.size)||"Bytes",this.formInline.excludeChats=(null===(u=this.filterEdits)||void 0===u||null===(f=u.criteria)||void 0===f?void 0:f.excludeChats)||!1,this.formInline.hasAttachment=(null===(h=this.filterEdits)||void 0===h||null===(b=h.criteria)||void 0===b?void 0:b.hasAttachment)||!1,this.$refs.form.clearValidate()},validate:function(){var e=this;return new Promise((function(t,i){e.$refs.form.validate((function(a){if(!a)return i(new Error("validate error"));var r=Object.values(e.formInline).some((function(e){return!!e}));return r?t(e.formInline):i(new Error("validate error"))}))}))},validateSizeValue:function(e,t,i){"MB"===this.formInline.sizeUnit&&t>=b/1e6&&i(new Error(this.$t("filter.sizeValueIsTooLarge"))),"KB"===this.formInline.sizeUnit&&t>=b/1e3&&i(new Error(this.$t("filter.sizeValueIsTooLarge"))),"Bytes"===this.formInline.sizeUnit&&t>=b&&i(new Error(this.$t("filter.sizeValueIsTooLarge"))),t&&t<1&&i(new Error(this.$t("filter.sizeValueMustBeLargerThan_1"))),i()}}},v=p,k=i(93483),I=(0,k.Z)(v,f,h,!1,null,"61ed90e1",null),C=I.exports,z=function(){var e=this,t=e._self._c;return t("section",{staticClass:"filter-actions-container"},[t("p",{staticClass:"label"},[e._v(e._s(e.$t("filter.filterActions")))]),t("zm-form",{ref:"form",staticClass:"filter-actions-form",attrs:{model:e.formInline,rules:e.rules,"label-position":"top"}},[t("zm-form-item",{attrs:{label:"",prop:"archiveChecked",for:"formInline-archiveChecked"}},[t("zm-checkbox",{attrs:{"aria-label":e.$t("filter.archiveEmail")},model:{value:e.formInline.archiveChecked,callback:function(t){e.$set(e.formInline,"archiveChecked",t)},expression:"formInline.archiveChecked"}},[t("span",{staticClass:"checkbox-label"},[e._v(e._s(e.$t("filter.archiveEmail")))])])],1),t("zm-form-item",{attrs:{label:"",prop:"markReadChecked",for:"formInline-markReadChecked"}},[t("zm-checkbox",{attrs:{"aria-label":e.$t("common.markAsRead")},model:{value:e.formInline.markReadChecked,callback:function(t){e.$set(e.formInline,"markReadChecked",t)},expression:"formInline.markReadChecked"}},[t("span",{staticClass:"checkbox-label"},[e._v(e._s(e.$t("common.markAsRead")))])])],1),t("zm-form-item",{attrs:{label:"",prop:"neverSpamChecked",for:"formInline-neverSpamChecked"}},[t("zm-checkbox",{attrs:{"aria-label":e.$t("filter.neverMarkAsSpam")},model:{value:e.formInline.neverSpamChecked,callback:function(t){e.$set(e.formInline,"neverSpamChecked",t)},expression:"formInline.neverSpamChecked"}},[t("span",{staticClass:"checkbox-label"},[e._v(e._s(e.$t("filter.neverMarkAsSpam")))])])],1),t("zm-form-item",{attrs:{label:"",prop:"deleteChecked",for:"formInline-deleteChecked"}},[t("zm-checkbox",{attrs:{"aria-label":e.$t("filter.deleteEmail")},model:{value:e.formInline.deleteChecked,callback:function(t){e.$set(e.formInline,"deleteChecked",t)},expression:"formInline.deleteChecked"}},[t("span",{staticClass:"checkbox-label"},[e._v(e._s(e.$t("filter.deleteEmail")))])])],1),t("zm-form-item",{attrs:{label:"",prop:"markStarredChecked",for:"formInline-markStarredChecked"}},[t("zm-checkbox",{attrs:{"aria-label":e.$t("filter.markAsStarred")},model:{value:e.formInline.markStarredChecked,callback:function(t){e.$set(e.formInline,"markStarredChecked",t)},expression:"formInline.markStarredChecked"}},[t("span",{staticClass:"checkbox-label"},[e._v(e._s(e.$t("filter.markAsStarred")))])])],1),t("zm-form-item",{attrs:{label:""}},[t("span",{staticClass:"user-labels"},[e._v(" "+e._s(e.$t("filter.applyLabel"))+" ")])]),t("zm-form-item",{attrs:{label:"",prop:"userSelectedLabel",for:"formInline-userSelectedLabel"}},[t("zm-select",{staticClass:"select-input-box",attrs:{id:"custom-select",filterable:"",placeholder:e.$t("filter.selectLabel"),label:e.$t("filter.multipleSelectDemo"),"popper-class":"custom-select","width-limit":"",clearable:""},model:{value:e.formInline.userSelectedLabel,callback:function(t){e.$set(e.formInline,"userSelectedLabel",t)},expression:"formInline.userSelectedLabel"}},e._l(e.userLabels,(function(i){return t("zm-option",{key:i.value,attrs:{label:i.label,value:i.value}},[t("zm-tooltip",{attrs:{content:i.label,placement:"bottom-end","break-word":""}},[t("div",{staticClass:"label-options"},[t("svg-label",{attrs:{labelClass:"stroke-label",labelColor:i.color}}),t("span",{staticClass:"label-name"},[e._v(e._s(i.label||"Unknown"))])],1)])],1)})),1)],1)],1)],1)},x=[],$=i(94182),E={name:"FilterActions",components:{SvgLabel:$.Z},props:{filterEdits:{type:Object},userLabels:{type:Array}},data:function(){return{formInline:{archiveChecked:!1,markReadChecked:!1,neverSpamChecked:!1,deleteChecked:!1,markStarredChecked:!1,userSelectedLabel:""},rules:{archiveChecked:[],markReadChecked:[],neverSpamChecked:[],deleteChecked:[],markStarredChecked:[],userSelectedLabel:[]}}},watch:{formInline:{handler:function(e){this.$emit("update",e)},immediate:!0}},methods:{init:function(){this.formInline.archiveChecked=!!this.filterEdits.action.removeLabelIds&&this.filterEdits.action.removeLabelIds.includes("INBOX"),this.formInline.markReadChecked=!!this.filterEdits.action.removeLabelIds&&this.filterEdits.action.removeLabelIds.includes("UNREAD"),this.formInline.neverSpamChecked=!!this.filterEdits.action.removeLabelIds&&this.filterEdits.action.removeLabelIds.includes("SPAM"),this.formInline.deleteChecked=!!this.filterEdits.action.addLabelIds&&this.filterEdits.action.addLabelIds.includes("TRASH"),this.formInline.markStarredChecked=!!this.filterEdits.action.addLabelIds&&this.filterEdits.action.addLabelIds.includes("STARRED"),this.formInline.userSelectedLabel=this.filterEdits.action.addLabelIds&&this.filterEdits.action.addLabelIds.filter((function(e){var t=["INBOX","UNREAD","SPAM","TRASH","STARRED"];return!t.includes(e)}))[0]||"",this.$refs.form.clearValidate()},validate:function(){var e=this;return new Promise((function(t,i){e.$refs.form.validate((function(a){return a?t(e.formInline):i(new Error("validate error"))}))}))}}},S=E,w=(0,k.Z)(S,z,x,!1,null,"62aca565",null),y=w.exports,_={name:"AddFilterDialog",components:{FilterCriteria:C,FilterActions:y},props:{filterEdits:{type:Object}},data:function(){return{visible:!1,step:1,isCriteriaExist:!1,isFulfilled:!1,loading:!1,criteriaData:null,actionsData:null}},computed:(0,o.Z)((0,o.Z)((0,o.Z)({},(0,m.rn)(["mailLabels"])),(0,m.Se)(["isZmail"])),{},{mode:function(){return this.filterEdits.id?"edit":"add"},userLabels:function(){return this.mailLabels.filter((function(e){return!e.isSystem})).map((function(e){return{value:e.id,label:e.name,color:e.backgroundColor}}))}}),watch:{visible:{handler:function(e){var t=this;e&&this.$nextTick((function(){t.$refs.criteriaForm.init(),t.$refs.actionsForm.init()}))},immediate:!0},criteriaData:{handler:function(e){this.isCriteriaExist=e&&Object.entries(e).filter((function(e){var t=(0,s.Z)(e,2),i=t[0],a=t[1];return!["sizeComparison","sizeUnit"].includes(i)&&!!a})).length>0},deep:!0,immediate:!0},actionsData:{handler:function(e){if(e){var t=Object.values(e).filter((function(e){return!!e}));this.isFulfilled=t.length>0}else this.isFulfilled=!1},deep:!0,immediate:!0}},methods:{createFilter:function(e){var t=this;return(0,l.Z)((0,n.Z)().mark((function i(){var a;return(0,n.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=3,u.wn.createFilter({action:e.action,criteria:e.criteria});case 3:a=i.sent,a||t.$msg(t.$t("filter.failedToCreateAFilter"));case 5:case"end":return i.stop()}}),i)})))()},updateFilter:function(e){var t=this;return(0,l.Z)((0,n.Z)().mark((function i(){var a;return(0,n.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=3,u.wn.updateFilter({id:e.id,action:e.action,criteria:e.criteria});case 3:a=i.sent,a?t.$undoNotice({title:t.$t("filter.filterHasBeenUpdated")}):t.$msg(t.$t("filter.failedToUpdateFilter"));case 5:case"end":return i.stop()}}),i)})))()},open:function(){this.visible=!0},close:function(){var e=this;this.visible=!1,setTimeout((function(){e.step=1}),400),Object.assign(this.criteriaData,this.$options.data.call(this).criteriaData),Object.assign(this.actionsData,this.$options.data.call(this).actionsData)},handleCriteriaUpdate:function(e){this.criteriaData=e},handleActionsUpdate:function(e){this.actionsData=e},handleNextStep:function(){var e=this;return(0,l.Z)((0,n.Z)().mark((function t(){return(0,n.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.criteriaForm.validate();case 2:e.step=2;case 3:case"end":return t.stop()}}),t)})))()},handleSubmit:function(){var e=this;return(0,l.Z)((0,n.Z)().mark((function t(){var i,a,r,l,s,c,m,u;return(0,n.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$refs.actionsForm.validate();case 3:e.loading=!0,i=Object.create(null),a=Object.create(null),t.t0=(0,n.Z)().keys(e.criteriaData);case 7:if((t.t1=t.t0()).done){t.next=16;break}if(r=t.t1.value,e.criteriaData.hasOwnProperty(r)){t.next=11;break}return t.abrupt("continue",7);case 11:if("sizeUnit"!==r){t.next=13;break}return t.abrupt("continue",7);case 13:"hasAttachment"===r||"excludeChats"===r?i[r]="true"===d().sanitize(e.criteriaData[r]).toLowerCase():"sizeValue"===r?e.criteriaData[r]&&("MB"===(null===(l=e.criteriaData)||void 0===l?void 0:l.sizeUnit)?i.size=1e3*Number(e.criteriaData[r])*1e3:"KB"===(null===(s=e.criteriaData)||void 0===s?void 0:s.sizeUnit)?i.size=1e3*Number(e.criteriaData[r]):i.size=Number(e.criteriaData[r])):i[r]="sizeComparison"===r?e.criteriaData[r]:d().sanitize(e.criteriaData[r]),t.next=7;break;case 16:a.forward="",a.removeLabelIds=[],a.addLabelIds=[],t.t2=(0,n.Z)().keys(e.actionsData);case 20:if((t.t3=t.t2()).done){t.next=42;break}if(c=t.t3.value,e.actionsData.hasOwnProperty(c)){t.next=24;break}return t.abrupt("continue",20);case 24:t.t4=c,t.next="archiveChecked"===t.t4?27:"markReadChecked"===t.t4?29:"neverSpamChecked"===t.t4?31:"deleteChecked"===t.t4?33:"markStarredChecked"===t.t4?35:"userSelectedLabel"===t.t4?37:39;break;case 27:return e.actionsData[c]&&a.removeLabelIds.push("INBOX"),t.abrupt("break",40);case 29:return e.actionsData[c]&&a.removeLabelIds.push("UNREAD"),t.abrupt("break",40);case 31:return e.isZmail?e.actionsData[c]&&a.addLabelIds.push("INBOX"):e.actionsData[c]&&a.removeLabelIds.push("SPAM"),t.abrupt("break",40);case 33:return e.actionsData[c]&&a.addLabelIds.push("TRASH"),t.abrupt("break",40);case 35:return e.actionsData[c]&&a.addLabelIds.push("STARRED"),t.abrupt("break",40);case 37:return e.actionsData[c]&&!a.addLabelIds.includes(e.actionsData[c])&&a.addLabelIds.push(e.actionsData[c]),t.abrupt("break",40);case 39:return t.abrupt("break",40);case 40:t.next=20;break;case 42:return m=["excludeChats"],[i,a].forEach((function(e,t){Object.keys(e).forEach((function(i){var a=e[i],r=Array.isArray(a)&&!a.length,n=""===a,l=0===t&&m.includes(i);(r||n||l)&&delete e[i]}))})),u=(0,o.Z)((0,o.Z)({},e.filterEdits),{},{criteria:i,action:a,id:""}),t.next=47,e.createFilter(u);case 47:e.$emit("submit",u),e.close(),t.next=54;break;case 51:t.prev=51,t.t5=t["catch"](0);case 54:return t.prev=54,e.loading=!1,t.finish(54);case 57:case"end":return t.stop()}}),t,null,[[0,51,54,57]])})))()},handleCancel:function(){this.$emit("cancel"),this.close(),this.loading=!1}}},L=_,A=(0,k.Z)(L,a,r,!1,null,"77b31dc1",null),g=A.exports}}]);