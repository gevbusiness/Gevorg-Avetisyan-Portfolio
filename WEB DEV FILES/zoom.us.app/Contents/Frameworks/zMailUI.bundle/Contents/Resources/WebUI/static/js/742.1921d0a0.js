"use strict";(self["webpackChunk_zoom_client_email_desktop"]=self["webpackChunk_zoom_client_email_desktop"]||[]).push([[742],{33742:function(e,t,i){i.r(t),i.d(t,{default:function(){return I}});var n=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"email-provider",attrs:{"element-loading-spinner":"zm-icon-loading"}},[t("landing-page",{on:{goZmail:function(t){return e["goto"](e.EMAIL_PROVIDER.ZMAIL)},goGoogle:function(t){return e["goto"](e.EMAIL_PROVIDER.GMAIL)},goOffice:function(t){return e["goto"](e.EMAIL_PROVIDER.OFFICE365)},goGoogleOrOffice:function(t){return e["goto"]("googleOrOffice365")}}})],1)},s=[],a=i(70021),r=i(56706),o=i(82456),c=function(){var e=this,t=e._self._c;return t("div",{staticClass:"landing-page"},[t("div",{staticClass:"page-content"},[e.isUserAgreeTermOfUse?t("div",[e.isFirstLogin?t("div",{staticClass:"escrow-consent"},[t("escrow-consent",{on:{backToLogin:function(t){return e.$store.commit("auth/setIsFirstLogin",!1)}}})],1):t("div",{staticClass:"connect-or-create"},[t("div",{staticClass:"logo"},[t("svg-icon",{attrs:{iconClass:"logo"}})],1),t("div",{staticClass:"login-title"},[e._v(" "+e._s(e.$t("landing.connectMail"))+" ")]),t("svg-icon",{staticClass:"login-img",attrs:{iconClass:"mail_calendar"}}),t("div",{staticClass:"operations"},[e.hasZmail?[e.isZmailTokenValid?t("zm-button",{staticClass:"operation",on:{click:function(t){return e.$emit("goZmail")}}},[t("svg-icon",{staticClass:"operation-icon",attrs:{iconClass:"app_logo"}}),t("div",[e._v(e._s(e.$t("landing.signIntoZmail")))])],1):t("zm-button",{staticClass:"operation",attrs:{href:e.isPaidUser?e.zmailConfigUrl:""},on:{click:function(t){!e.isPaidUser&&(e.showModal=!0)}}},[t("svg-icon",{staticClass:"operation-icon",attrs:{iconClass:"app_logo"}}),t("div",[t("div",{staticClass:"create-account"},[t("span",[e._v(" "+e._s(e.$t("landing.createZoomMail")))])]),t("div",{staticClass:"example"},[e._v(e._s(e.$t("landing.createExample")))])])],1),t("div",{staticClass:"split-line"},[t("div",{staticClass:"line"}),t("span",[e._v(e._s(e.$t("landing.or")))]),t("div",{staticClass:"line"})])]:e._e(),e.hasGmail?t("zm-button",{staticClass:"operation_img",attrs:{href:e.isGmailTokenValid?"":e.authConfigUrl},nativeOn:{click:function(t){return e.connectGmailBtnClick.apply(null,arguments)}}},[t("svg-icon",{attrs:{iconClass:"signin_google"}})],1):e._e(),e.hasOffice365?t("zm-button",{staticClass:"operation_img",attrs:{href:e.isOffice365TokenValid?"":e.authConfigUrl},nativeOn:{click:function(t){return e.connectOfficeBtnClick.apply(null,arguments)}}},[t("svg-icon",{attrs:{iconClass:"signin_office"}})],1):e._e()],2)],1)]):t("div",[t("svg-icon",{staticClass:"agree-img",attrs:{iconClass:"welcome_bg"}}),t("div",{staticClass:"title"},[e._v(e._s(e.$t("landing.welcomeToMail")))]),t("div",{staticClass:"description"},[e._v(e._s(e.$t("landing.accessEverything")))]),t("div",{staticClass:"term-of-use"},[e._v(" "+e._s(e.$t("landing.zoomMailAreAvailable"))+" "),t("a",{attrs:{href:"https://explore.zoom.us/en/beta-terms-and-conditions/"}},[e._v(e._s(e.$t("landing.termOfUseLink")))])]),t("div",{staticClass:"agree-and-start"},[t("zm-button",{attrs:{type:"primary"},on:{click:e.agreeAndGetStarted}},[e._v(e._s(e.$t("landing.getStarted")))])],1)],1)]),t("zm-dialog",{staticClass:"landing-page-modal",attrs:{width:"490px",visible:e.showModal,"append-to-body":""},on:{"update:visible":function(t){e.showModal=t}}},[t("div",{staticClass:"view-plan"},[t("div",{staticClass:"logo"},[t("svg-icon",{attrs:{iconClass:"logo"}})],1),t("div",{staticClass:"title"},[e._v(" "+e._s(e.$t("landing.updateToZoomPro"))+" "),t("svg-icon",{staticClass:"license_icon",attrs:{iconClass:"license_icon"}})],1),t("div",{staticClass:"description"},[e._v(" "+e._s(e.upgradeLink?e.$t("landing.youHaveAFreeZoomAccount"):e.$t("landing.askLicense"))+" ")]),e.upgradeLink?t("zm-button",{staticClass:"view-plan__button",attrs:{href:e.upgradeLink,type:"primary"}},[e._v(" "+e._s(e.$t("landing.viewPlans"))+" ")]):e._e(),e.upgradeLink?t("zm-button",{staticClass:"view-plan__button",on:{click:e.handleClose}},[e._v(e._s(e.$t("landing.maybeLater")))]):t("zm-button",{staticClass:"view-plan__button",attrs:{type:"primary"},on:{click:e.handleClose}},[e._v(e._s(e.$t("landing.gotit")))])],1)])],1)},l=[],d=i(34948),u=i(20629),m=i(63012),g=i(87671),p=function(){var e=this,t=e._self._c;return t("div",{staticClass:"escrow"},[e._m(0),t("b",{staticClass:"escrow-title"},[e._v(" "+e._s(e.$t("escrow.title"))+" ")]),t("div",{staticClass:"escrow-description"},[e._v(" "+e._s(e.$t("escrow.description"))+" ")]),t("div",{staticClass:"escrow-loading-container"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isFetching,expression:"!isFetching"}],staticClass:"escrow-backup"},[e._v(e._s(e.formattedKey))]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isFetching&&!e.isFailed||e.isRetry,expression:"(isFetching && !isFailed) || isRetry"},{name:"loading",rawName:"v-loading",value:e.isFetching&&!e.isFailed||e.isRetry,expression:"(isFetching && !isFailed) || isRetry"}],staticClass:"escrow-loading",attrs:{"element-loading-text":e.$t("escrow.fetchingBackup"),"element-loading-spinner":"zm-icon-loading"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isFailed&&!e.isRetry,expression:"isFailed && !isRetry"}],staticClass:"escrow-fail"},[t("zm-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.getBackupKey(!0)}}},[e._v(" "+e._s(e.$t("escrow.retryBackup"))+" ")])],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isFetching,expression:"!isFetching"}],staticClass:"escrow-copy",on:{click:e.copyKey}},[e._v(" "+e._s(e.$t("escrow.copyKey"))+" ")]),t("div",{class:"escrow-footer ".concat(e.needSendMail?"":"more-margin")},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.needSendMail,expression:"needSendMail"}],staticClass:"escrow-note"},[e._v(" "+e._s(e.$t("escrow.postNote"))+" ")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.needSendMail&&!e.adminDetailFetching,expression:"needSendMail && !adminDetailFetching"}],staticClass:"escrow-admin-info"},[e._v(" "+e._s(e.adminName)+" ")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.needSendMail&&!e.adminDetailFetching,expression:"needSendMail && !adminDetailFetching"}],staticClass:"escrow-admin-info"},[e._v(" "+e._s(e.formattedAdminEmail)+" ")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.needSendMail&&!e.adminDetailFetching,expression:"needSendMail && !adminDetailFetching"}],staticClass:"escrow-admin-info"},[e._v(" "+e._s(e.displayFingerprint)+" ")]),t("div",{staticClass:"escrow-buttons"},[t("zm-button",{staticClass:"back",attrs:{size:"large"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.backToLogin.apply(null,arguments)}}},[e._v(" "+e._s(e.$t("escrow.back"))+" ")]),t("zm-button",{staticClass:"consent",attrs:{type:"primary",size:"large",disabled:e.isFetching||e.isFailed||e.isRetry},on:{click:function(t){t.stopPropagation(),t.preventDefault(),e.needSendMail?e.handleSendEscrow():e.goToMainPage()}}},[e._v(" "+e._s(e.$t(e.needSendMail?"escrow.consent":"landing.next"))+" ")])],1)])])},f=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"escrow-zoom"},[t("img",{staticClass:"escrow-zoom",attrs:{src:i(75712),alt:"Splash zoom image"}})])}],h=i(95740),v={getEscrowAdmin:function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,window.zoomSdk.postJsMessage({functionName:"mailui_getescrowadminprofile",params:{}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},w=i(27804),C={name:"EscrowConsent",data:function(){return{isFetching:!0,isFailed:!1,isRetry:!1,generateKey:"",formattedKey:"",adminEmail:"",formattedAdminEmail:"",adminName:"",fingerprint:"",adminDetailFetching:!0,messageInstance:null}},computed:(0,d.Z)((0,d.Z)((0,d.Z)({},(0,u.rn)({userEscrowTime:function(e){return e.userProfile.escrowTime},userEmail:function(e){return e.userProfile.userEmail},userTimeZone:function(e){return e.userProfile.userTimeZone},typeOfEmail:function(e){return e.typeOfEmail}})),(0,u.rn)({isCorpUser:function(e){return e.userProfile.isCorpUser},isEscrowAdmin:function(e){return e.userProfile.isEscrowAdmin}})),{},{needSendMail:function(){return this.isCorpUser&&!this.isEscrowAdmin},displayFingerprint:function(){return"<"+this.fingerprint+">"}}),watch:{generateKey:function(){32===this.generateKey.length&&(this.isFetching=!1,this.isFailed=!1,this.isRetry=!1)}},created:function(){this.getBackupKey(),this.needSendMail&&this.getEscrowAdmin(),this.$Bus.$on("onEscrowAdminFingerprintChange",this.refreshAdminFingerprint)},beforeDestroy:function(){this.$Bus.$off("onEscrowAdminFingerprintChange",this.refreshAdminFingerprint)},methods:(0,d.Z)((0,d.Z)({},(0,u.OI)(["setUserProfile"])),{},{copyKey:function(){var e=this.generateKey;navigator&&navigator.clipboard&&navigator.clipboard.writeText&&(navigator.clipboard.writeText(e),this.$undoNotice({iconClass:"checkmark",title:"Copied to clipboard!",isFromLogin:!0}))},goToMainPage:function(){"main"!==this.$route.name&&this.$router.replace({name:"main"})},backToLogin:function(){o.g.backToLogin(),this.$emit("backToLogin")},getEscrowAdmin:function(){var e=this;return(0,r.Z)((0,a.Z)().mark((function t(){return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:v.getEscrowAdmin().then(function(){var t=(0,r.Z)((0,a.Z)().mark((function t(i){var n;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=i.result.GetEscrowAdminProfile,0!==i.returnCode){t.next=11;break}if(e.adminEmail=n.escrowAdmin,e.formattedAdminEmail=" <"+n.escrowAdmin+">",e.adminName=n.firstName+" "+n.lastName,!e.needSendMail){t.next=8;break}return t.next=8,e.fetchFingerprint(n.escrowAdmin);case 8:e.adminDetailFetching=!1,t.next=12;break;case 11:case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())["catch"]((function(){}));case 1:case"end":return t.stop()}}),t)})))()},getBackupKey:function(){var e=arguments,t=this;return(0,r.Z)((0,a.Z)().mark((function i(){var n,s;return(0,a.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n=e.length>0&&void 0!==e[0]&&e[0],t.isRetry=n,i.next=4,window.zoomSdk.postJsMessage({functionName:"mailui_generatebackupkey",params:{}});case 4:s=i.sent,0===s.returnCode?(t.generateKey=s.result.GenerateBackupKey.backupKey,t.formattedKey=t.generateKey.split(" ").join("-"),t.isFetching=!1,t.isRetry=!1,t.isFailed=!1):(t.isFailed=!0,t.isRetry=!1,t.$msg("Generate key failed, please retry"),window.zoomLog("INFO",s.returnCode+": "+s.errorMessage)),window.zoomLog("INFO",JSON.stringify(s));case 7:case"end":return i.stop()}}),i)})))()},handleSendEscrow:function(){var e=this;return(0,r.Z)((0,a.Z)().mark((function t(){var i,n,s,r,o,c,l;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={subject:"ESCROW - ".concat(e.userEmail),content:"Backup Key: ".concat(e.formattedKey),msgId:"",toUserEmail:[{emailAddr:"".concat(e.adminEmail),displayName:"".concat(e.adminName)}],isEscrow:!0,userFingerprints:e.needSendMail&&e.fingerprint?[{email:e.adminEmail,fingerprint:e.fingerprint}]:[]},t.prev=1,e.$undoNotice({iconClass:"loading",title:"Sending...",isFromLogin:!0}),null===(n=e.messageInstance)||void 0===n||n.hide(),t.next=6,h.l.sendDraftMail(i);case 6:if(s=t.sent,0!==s.returnCode){t.next=16;break}return e.$undoNotice({iconClass:"checkmark",title:"Escrow email sent"}),t.next=11,window.zoomSdk.postJsMessage({functionName:"mailui_getmailuserprofile",params:{}});case 11:r=t.sent,e.$store.commit("setUserProfile",r.result.GetMailUserProfile),e.goToMainPage(),t.next=21;break;case 16:e.messageInstance=e.$msg({content:e.$t("escrow.sendFail"),isEscrow:!0}),o=JSON.parse(s.errorMsg),c=o.ErrFingerprintEmails.map((function(e){return e.email})),e.$Bus.$emit("onZmailFingerprintChange",{recipients:c,isEscrow:!0});case 21:t.next=27;break;case 23:t.prev=23,t.t0=t["catch"](1),null===(l=e.messageInstance)||void 0===l||l.hide(),e.messageInstance=e.$msg({content:e.$t("escrow.sendFail"),isEscrow:!0});case 27:case"end":return t.stop()}}),t,null,[[1,23]])})))()},fetchFingerprint:function(e){var t=this;return(0,r.Z)((0,a.Z)().mark((function i(){return(0,a.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,w.p.getFingerprint(e).then((function(e){0===e.returnCode&&(t.fingerprint=e.result.GetMailUserFingerprint.fingerprint)}))["catch"]((function(e){}));case 2:case"end":return i.stop()}}),i)})))()},refreshAdminFingerprint:function(){this.fetchFingerprint(this.adminEmail)}})},_=C,k=i(93483),y=(0,k.Z)(_,p,f,!1,null,"165dd88e",null),F=y.exports,M=g.Yb.EMAIL_PROVIDER,b={name:"LandingPage",components:{EscrowConsent:F},data:function(){return{showModal:!1,generateKey:"",formattedKey:"",adminEmail:"",adminName:"",userEmail:"",supportMailTypes:[]}},computed:(0,d.Z)((0,d.Z)({},(0,u.rn)("auth",["isZmailTokenValid","isGmailTokenValid","isUserAgreeTermOfUse","isOffice365TokenValid","isFirstLogin","isPaidUser","upgradeLink","zmailConfigUrl","authConfigUrl"])),{},{isTokenValid:function(){return this.isGmailTokenValid||this.isOffice365TokenValid},hasZmail:function(){return this.supportMailTypes.includes(M.ZMAIL)},hasGmail:function(){return this.supportMailTypes.includes(M.GMAIL)},hasOffice365:function(){return this.supportMailTypes.includes(M.OFFICE365)}}),created:function(){this.getSupportMailTypes()},mounted:function(){var e=this;this.$Bus.$on(g.Yb.Notification.OnMessageFromCalendar,function(){var t=(0,r.Z)((0,a.Z)().mark((function t(i){var n;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:0===i.returnCode&&(n=i.result.CalendarMsgType,"ClickGetStarted"===n&&(m.gx.confirmAgreeTheUserAgreement(),e.$store.commit("auth/setIsUserAgreeTermOfUse",!0)));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},methods:{agreeAndGetStarted:function(){var e=this;return(0,r.Z)((0,a.Z)().mark((function t(){return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:m.gx.confirmAgreeTheUserAgreement(),e.$store.commit("auth/setIsUserAgreeTermOfUse",!0);case 2:case"end":return t.stop()}}),t)})))()},connectGmailBtnClick:function(){this.isGmailTokenValid?this.$emit("goGoogle"):this.$store.commit("auth/setClickedExtraMail",M.GMAIL)},connectOfficeBtnClick:function(){this.isOffice365TokenValid?this.$emit("goOffice"):this.$store.commit("auth/setClickedExtraMail",M.OFFICE365)},getSupportMailTypes:function(){var e=this;return(0,r.Z)((0,a.Z)().mark((function t(){var i,n;return(0,a.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m.gx.getSupportMailTypes();case 2:n=t.sent,e.supportMailTypes=(null===n||void 0===n||null===(i=n.data)||void 0===i?void 0:i.supportMailTypes)||[];case 4:case"end":return t.stop()}}),t)})))()},handleClose:function(){this.showModal=!1}}},x=b,E=(0,k.Z)(x,c,l,!1,null,"51dfe391",null),$=E.exports,Z=g.Yb.EMAIL_PROVIDER,A={name:"EmailProvider",components:{LandingPage:$},data:function(){return{loading:!1,messageInstance:null,EMAIL_PROVIDER:Z}},created:function(){var e,t=this;null!==(e=this.$route.params)&&void 0!==e&&e.reAuth&&(this.loading=!0,setTimeout((function(){t.loading=!1}),5e3))},mounted:function(){this.$store.commit("changeLoading",!1),this.$Bus.$on("ZMailUINotif_OnMailAuthDone",this.authDoneHandler)},beforeDestroy:function(){this.$Bus.$off("ZMailUINotif_OnMailAuthDone",this.authDoneHandler)},methods:{goto:function(e){var t=this;return(0,r.Z)((0,a.Z)().mark((function i(){var n,s,r,c,l;return(0,a.Z)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(t.loading){i.next=41;break}if(n=e,i.prev=2,t.loading=!0,null===(s=t.$parent)||void 0===s||null===(r=s.messageInstance)||void 0===r||r.hide(),null===(c=t.messageInstance)||void 0===c||c.hide(),e!==Z.GMAIL){i.next=13;break}return i.next=9,o.g.startGmailLogin();case 9:if(i.sent){i.next=11;break}throw new Error("startGmailLogin not success");case 11:i.next=29;break;case 13:if(e!==Z.ZMAIL){i.next=20;break}return i.next=16,o.g.startZmailLogin();case 16:if(i.sent){i.next=18;break}throw new Error("startZmailLogin not success");case 18:i.next=29;break;case 20:if(e!==Z.OFFICE365){i.next=27;break}return i.next=23,o.g.startOutlookLogin();case 23:if(i.sent){i.next=25;break}throw new Error("startOutlookLogin not success");case 25:i.next=29;break;case 27:t.loading=!1;case 29:i.next=37;break;case 31:i.prev=31,i.t0=i["catch"](2),null===(l=t.messageInstance)||void 0===l||l.hide(),t.messageInstance=t.$msg({content:t.$t("common.startMailLoginFailed",[n]),duration:0}),t.loading=!1;case 37:return i.prev=37,setTimeout((function(){t.loading=!1}),3e4),i.finish(37);case 41:case"end":return i.stop()}}),i,null,[[2,31,37,41]])})))()},authDoneHandler:function(e){var t,i=null===(t=e.result)||void 0===t?void 0:t.authStatus;"fail"===i&&(this.loading=!1)}}},T=A,O=(0,k.Z)(T,n,s,!1,null,"4c88ccc5",null),I=O.exports},75712:function(e,t,i){e.exports=i.p+"static/img/zoom.76b2aa6f.svg"}}]);