"use strict";(self["webpackChunk_zoom_client_email_desktop"]=self["webpackChunk_zoom_client_email_desktop"]||[]).push([[227],{6227:function(t,e,n){n.r(e),n.d(e,{default:function(){return S}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"attachments"},[t._l(t.cacheAttachments,(function(n,a){return e("attachment-item",{key:a,attrs:{attachmentItem:n,index:a},on:{attachmentItemMounted:t.attachmentItemMounted,handleDownLoad:t.handleDownLoad,handleCancel:t.handleCancel,handleOpen:t.handleOpen}})})),t.attachments.length-t.cacheAttachments.length>0?e("div",{staticClass:"attachments-more",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.openAttachments.apply(null,arguments)}}},[t._v(" +"+t._s(t.attachments.length-t.cacheAttachments.length)+" ")]):t._e()],2)},o=[],i=function(){var t=this,e=t._self._c;return e("div",{class:["select-item",{showClick:"None"===t.attachmentItem.downloadStatus,select:t.select,showOpen:"Finish"===t.attachmentItem.downloadStatus,showError:"Error"===t.attachmentItem.downloadStatus,showDownload:"Downloading"===t.attachmentItem.downloadStatus}],on:{click:function(e){e.stopPropagation(),e.preventDefault(),!t.downloadInProgress&&t.handleOpen()}}},[e("confirm-dialog",{attrs:{visible:t.showExecutableDownloadAlert,content:t.$t("detail.executableDownloadWarningContent",[t.attachmentItem.fileName]),hasBold:!1,actions:t.downloadExecutableActions,title:t.$t("detail.executableDownloadWarningTitle"),width:"600px"}}),e("div",{staticClass:"select-item_left"},[e("img",{attrs:{src:t.getIcon(t.attachmentItem[t.type],t.prefersColorScheme),alt:""}})]),e("div",{staticClass:"select-item_right"},[e("zm-tooltip",{attrs:{"popper-class":"attachment-name-tooltip",placement:"bottom",content:t.attachmentItem[t.type]}},[e("div",{staticClass:"name"},[t._v(t._s(t.attachmentItem[t.type]))])]),e("div",{staticClass:"size"},["Finish"===t.attachmentItem.downloadStatus?e("i",{staticClass:"zm-icon-upload-success zm-icon-success success-icon"}):t._e(),e("div",{staticClass:"open"},[t._v(t._s(t.$t("operation.clickToOpen")))]),"Error"===t.attachmentItem.downloadStatus?e("span",{staticClass:"errors"},[e("i",{staticClass:"zm-icon-corner-error error-icon"}),e("div",{staticClass:"download-error"},[t._v(t._s(t.$t("common.error")))]),e("span",{staticClass:"retry-download",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleDownLoad(t.attachmentItem)}}},[t._v(" "+t._s(t.$t("common.retry"))+" ")])]):t._e(),"Downloading"!==t.attachmentItem.downloadStatus&&"Error"!==t.attachmentItem.downloadStatus?e("span",{staticClass:"down-size"},[t._v(" "+t._s(t.formatSize(t.attachmentItem.size))+" ")]):t._e(),e("span",{staticClass:"down",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleDownLoad(t.attachmentItem)}}},[t._m(0),e("div",{staticClass:"download-click"},[t._v(t._s(t.$t("operation.clickToDownload")))])]),"Downloading"===t.attachmentItem.downloadStatus?e("div",{staticClass:"control",style:{display:"flex",flex:"1"}},[e("div",{style:{flex:"1"}},[e("zm-progress",{attrs:{percentage:t.percentage,"show-text":!0}})],1),e("i",{staticClass:"zm-icon-close m-l",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleCancel.apply(null,arguments)}}})]):t._e()])],1)],1)},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"download-icon"},[e("i",{staticClass:"zm-icon-upload-success zm-icon-download-alt-thin"})])}],l=n(34948),c=n(69969),h=n(71071),d=n(87693),r=n(20629),m={components:{ConfirmDialog:c.Q},props:{index:Number,select:{type:Boolean,default:!1},attachmentItem:{type:Object,required:!0},type:{type:String,default:"fileName"},showDelete:{type:Boolean,default:!0}},data:function(){return{showExecutableDownloadAlert:!1,downloadExecutableActions:[{id:"cancel",className:"cancel-download-executable",handler:this.cancelDownloadExecutable,text:this.$t("operation.cancel")},{id:"downloadExecutable",className:"download-executable",handler:this.handleDownloadExecutable,text:this.$t("operation.download"),type:"primary"}]}},computed:(0,l.Z)((0,l.Z)({},(0,r.rn)(["prefersColorScheme"])),{},{extName:function(){return this.isCamera(this.attachmentItem.fileName)?"camera":this.isVideo(this.attachmentItem.fileName)?"video":"camera"},progressStyle:function(){return{width:100*this.attachmentItem.percentage+"%"}},percentage:function(){return this.$store.getters.attDownloadRatio(this.attachmentItem.msgId,this.attachmentItem.aid)},downloadInProgress:function(){return"Downloading"===this.attachmentItem.downloadStatus}}),mounted:function(){var t=this.$el.getBoundingClientRect().width;this.$emit("attachmentItemMounted",{index:this.index,width:t})},methods:{cancelDownloadExecutable:function(){this.showExecutableDownloadAlert=!1},handleCancel:function(){this.$emit("handleCancel",this.attachmentItem)},handleOpen:function(){"Finish"===this.attachmentItem.downloadStatus?this.$emit("handleOpen",this.attachmentItem):"Finish"===this.attachmentItem.downloadStatus&&"Downloading"===this.attachmentItem.downloadStatus||this.handleDownLoad(this.attachmentItem)},handleDownloadExecutable:function(){this.showExecutableDownloadAlert=!1,this.$emit("handleDownLoad",this.attachmentItem)},isExecutableFile:function(t){var e=new Set(["0XE","73K","89K","8CK","A6P","A7R","AC","ACC","ACR","ACTION","AHK","AIR","APK","APP","APPIMAGE","BAT","BA_","BIN","BMS","CACTION","CELX","CGI","CMD","COF","COFFEE","COM","COMMAND","DEK","DLD","EBS2","ECF","ELF","EX4","EXE","EXE","EX_","EX_","FAS","FBA","FPI","FXP","GADGET","GPE","HTA","IPA","ISU","JAR","JS","JSF","JSX","M3G","MCR","MLX","OUT","PAF","PHAR","PIF","PLSC","PS1","PY","RBF","RFU","RPJ","RUN","RXE","SCAR","SCB","SCPT","SCR","SCRIPT","SERVER","SH","SHB","SK","TCP","TPK","U3P","VBS","VLX","VPM","VXP","WIDGET","WORKFLOW","WS","WSH","X86","X86_64","XAP","XBAP","XBE","XEX","XLM"]),n=t.split(".").pop().toUpperCase();return e.has(n)},handleDownLoad:function(t){this.isExecutableFile(t.fileName)?this.showExecutableDownloadAlert=!0:this.$emit("handleDownLoad",t)},isCamera:function(t){var e=/(\.png$)|(\.jpg$)|(\.PNG$)|(\.JPG$)/;return e.test(t)},isVideo:function(t){var e=/(\.mp4$)/;return e.test(t)},getIcon:function(t,e){return(0,h.L)(t,e)},formatName:function(t){return(0,d.Ec)(t)>20?t.slice(0,3)+"..."+t.slice(t.length-13,t.length):t},formatSize:function(t){return t<1024?t+"bytes":t>=1024&&t<1048576?(t/1024).toFixed(1)+"KB":t>=1048576?(t/1048576).toFixed(1)+"MB":void 0}}},u=m,p=n(93483),w=(0,p.Z)(u,i,s,!1,null,"def62a40",null),f=w.exports,C={name:"Attachment",components:{attachmentItem:f},props:{attachments:{type:Array,default:function(){return[]}}},data:function(){return{itemSum:[55],width:0,index:this.attachments.length+1,full:!1}},computed:{cacheAttachments:function(){return this.attachments.slice(0,this.index-1)}},watch:{width:{handler:function(t){this.index=this.itemSum.findIndex((function(e){return e>t})),this.width>this.itemSum[this.itemSum.length-1]&&(this.index=this.itemSum.length)}}},mounted:function(){var t=this;this.width=this.$el.getBoundingClientRect().width,this.resizeHandler=function(){t.width=t.$el.getBoundingClientRect().width},window.addEventListener("resize",this.resizeHandler)},beforeDestroy:function(){window.removeEventListener("resize",this.resizeHandler)},methods:{handleOpen:function(t){this.$emit("handleOpen",t)},handleCancel:function(t){this.$emit("handleCancel",t)},openAttachments:function(){this.index=this.attachments.length+1},handleDownLoad:function(t){this.$emit("handleDownLoad",t)},attachmentItemMounted:function(t){var e=t.index,n=t.width;if(!this.full){var a=0,o=this.itemSum[e];a=n+o,this.itemSum.push(a),this.itemSum.length===this.attachments.length+1&&(this.full=!0)}}}},I=C,g=(0,p.Z)(I,a,o,!1,null,"3746369a",null),S=g.exports}}]);